# TimeTree Workflow Configuration
# OrthoFinder -> IQ2MC + MCMCtree

# === Input Paths ===
orthofinder_dir: "data/orthofinder"  # OrthoFinder run directory
results_dir: "data/orthofinder/Results_May01"  # Specific Results_* folder
proteomes_dir: "data/proteomes"  # Original protein FASTAs

# === Calibration ===
calibration_table: "config/calibrations.tsv"  # TSV with taxa_csv, min_age, max_age columns
calibration_unit: "Myr"  # Myr or yr

# === Rooting ===
# IMPORTANT: When using tree_method="coalescent", outgroup_taxa is REQUIRED
# Coalescent-based species trees cannot use midpoint rooting
outgroup_taxa: []  # List of outgroup taxa for rooting, e.g. ["species1", "species2"]

# === Species Tree Method ===
# "concatenation" - Build supermatrix and infer ML tree (traditional approach)
#                   Outgroup is optional (midpoint rooting will be used if not specified)
# "coalescent"    - Build gene trees and use ASTRAL (robust to ILS)
#                   REQUIRES outgroup_taxa to be set (will error if not specified)
tree_method: "concatenation"

# === SCO Filtering ===
sco:
  min_taxa: 4  # Minimum number of taxa per orthogroup
  allow_missing: false  # If true, allow orthogroups missing some species
  min_sco: 100  # Minimum number of SCO families required (error if fewer)

# === Multiple Sequence Alignment ===
msa:
  method: "mafft"  # mafft
  mafft_opts: "--auto"
  
# === Trimming ===
trim:
  method: "trimal"  # trimal or clipkit
  trimal_opts: "-automated1"

# === IQ-TREE ML Tree ===
iqtree:
  model: "MFP"  # MFP for ModelFinder, or specify e.g. "LG+G4"
  use_partition: true  # Use partition model
  bootstrap: 0  # UFBoot replicates, 0 to disable
  threads: "AUTO"

# === Tool binaries ===
# Notes:
# - IQ2MC step2 REQUIRES IQ-TREE 3 (`iqtree3`) for `--dating mcmctree` as described in:
#   https://iqtree.github.io/doc/Dating
# - For IQ2MC step2, set `iqtree_dating` to `iqtree3` or an absolute path.
binaries:
  iqtree_ml: ""       # e.g. "iqtree3" or "iqtree"
  iqtree_dating: ""   # REQUIRED: "iqtree3" (or absolute path to iqtree3)
  mcmctree: "mcmctree"

# === IQ2MC / MCMCtree ===
mcmctree:
  clock_model: "IND"  # IND (independent rates), CORR (correlated), EQUAL (strict clock)
  burnin: 20000
  samplefreq: 200
  nsample: 50000
  birth_rate: 1.0
  death_rate: 1.0
  sampling_fraction: 0.5

# === Visualization (ggtree) ===
visualization:
  time_unit: "Ma"  # Time unit for axis label: Ma, Myr, kya, etc.

# === Output ===
output_dir: "results/timetree"
work_dir: "work"

# === Coalescent Method (ASTRAL) ===
coalescent:
  gene_tree_model: "MFP"  # Model for gene tree inference, MFP for ModelFinder
  gene_tree_threads: 2    # Threads per gene tree inference
  astral_bin: "astral"    # ASTRAL binary or path to .jar file
  astral_opts: ""         # Extra ASTRAL options, e.g. "-t 2" for scoring
  astral_threads: 4       # Threads for ASTRAL (if supported)
