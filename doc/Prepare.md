

# 输入准备

## 多倍体物种处理指南 [TODO]

## 获取基因家族

以 OrthoFinder 为例, 我们要保证输入符合如下要求

- 每个基因只有一个蛋白，如果存在多个isoform，理论上来说是选择最具有表达量最高的，但实际操作中可以用最长的
- 蛋白质序列中，'U' 代表硒半胱氨酸 (Selenocysteine)，这是第 21 种氨基酸。虽然它在生物学上是合法的，但很多生物信息学软件（包括默认设置的 MAFFT 和后续的建树软件）不一定能直接识别它，要么删除这个基因，要么替换为X.


预处理脚本:`scripts/preprocess_pep.py`

1. 简化ID - 只保留序列名（第一个空格前），如 >NP_001001398.2
2. 去除末尾  - 移除序列末尾的终止密码子符号
3. 过滤内部终止密码子 - 删除序列中间包含 * 的蛋白（共过滤125条）
4. 替换非标准氨基酸 - 将非20种标准AA替换为模糊码 X（共修正2,912条）



